<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Track and visualize incidents of violence against Dalit, Bahujan, Adivasi, and Minority communities in India">
    <meta name="keywords" content="Dalit, Bahujan, Adivasi, Minority, India, Violence Tracker, Hate Crimes, Discrimination">
    <meta name="author" content="DalitViolenceTracker">
    <meta name="theme-color" content="#ffffff">
    
    <!-- Favicon -->
    <link rel="apple-touch-icon" sizes="180x180" href="assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="site.webmanifest">
    <link rel="mask-icon" href="assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#da532c">
    
    <title>India Violence Tracker</title>
    
    <!-- Styles -->
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    
    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col overflow-x-hidden">
    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <img src="assets/logo.svg" alt="Dalit Violence Tracker Logo" class="h-10 w-10">
                <div>
                    <h1 class="text-2xl md:text-3xl font-bold text-gray-900">India Dalit Violence Tracker</h1>
                    <p class="text-sm text-gray-500">Tracking incidents of violence and hate crimes</p>
                </div>
            </div>
            <button id="themeToggle" class="ml-4 px-3 py-2 rounded-md bg-primary-100 text-primary-700 hover:bg-primary-200 focus:outline-none focus:ring-2 focus:ring-primary-300 transition-colors duration-150" aria-label="Toggle dark mode">
                <span id="themeIcon">🌙</span>
            </button>
            <button class="md:hidden" id="mobileMenuButton">
                <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                </svg>
            </button>
        </div>
        <!-- Mobile Menu -->
        <div class="hidden md:hidden" id="mobileMenu">
            <div class="px-2 pt-2 pb-3 space-y-1">
                <a href="#map" class="block px-3 py-2 text-gray-600 hover:text-primary-600">Map</a>
                <a href="#stats" class="block px-3 py-2 text-gray-600 hover:text-primary-600">Statistics</a>
                <a href="#data" class="block px-3 py-2 text-gray-600 hover:text-primary-600">Data</a>
                <a href="#about" class="block px-3 py-2 text-gray-600 hover:text-primary-600">About</a>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow max-w-7xl w-full mx-auto px-2 sm:px-4 md:px-8 py-8">
        <!-- Tab Bar -->
        <div class="mb-6 flex flex-row space-x-2 border-b border-gray-200 bg-white rounded-t-lg shadow-sm px-2 md:px-6 py-2 sticky top-0 z-40" role="tablist">
            <button class="tab-btn px-4 py-2 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent focus:outline-none focus:text-primary-600" id="tab-map" role="tab" aria-controls="tabPanel-map" aria-selected="true">Map</button>
            <button class="tab-btn px-4 py-2 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent focus:outline-none focus:text-primary-600" id="tab-stats" role="tab" aria-controls="tabPanel-stats" aria-selected="false">Statistics</button>
            <button class="tab-btn px-4 py-2 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent focus:outline-none focus:text-primary-600" id="tab-data" role="tab" aria-controls="tabPanel-data" aria-selected="false">Data</button>
            <button class="tab-btn px-4 py-2 text-sm md:text-base font-medium text-gray-600 border-b-2 border-transparent focus:outline-none focus:text-primary-600" id="tab-about" role="tab" aria-controls="tabPanel-about" aria-selected="false">About</button>
        </div>
        <!-- Tab Panels -->
        <div id="tabPanel-map" class="tab-panel min-h-[400px]" role="tabpanel" aria-labelledby="tab-map">
            <!-- Map Section -->
            <div class="bg-white rounded-lg shadow p-6 mb-8">
                <h2 class="text-xl font-semibold mb-4">Incident Map</h2>
                <div id="mapContainer" class="w-full bg-primary-50 min-h-[350px] h-[350px] md:h-[500px] xl:h-[650px] rounded-lg"></div>
            </div>
        </div>
        <div id="tabPanel-stats" class="tab-panel hidden min-h-[400px]" role="tabpanel" aria-labelledby="tab-stats">
            <!-- Statistics Section -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8" id="stats">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900">This Week's Incidents</h3>
                    <p class="mt-2 text-3xl font-bold text-indigo-600" id="weeklyCount">Loading...</p>
                </div>
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900">This Month's Incidents</h3>
                    <p class="mt-2 text-3xl font-bold text-indigo-600" id="monthlyCount">Loading...</p>
                </div>
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900">Most Affected State</h3>
                    <p class="mt-2 text-3xl font-bold text-indigo-600" id="mostAffectedState">Loading...</p>
                </div>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-xl font-semibold mb-4">State-wise Distribution</h2>
                    <canvas id="stateChart" class="w-full min-h-[200px] h-64"></canvas>
                </div>
                <div class="bg-white rounded-lg shadow p-6">
                    <h2 class="text-xl font-semibold mb-4">Incident Types</h2>
                    <canvas id="incidentTypeChart" class="w-full min-h-[200px] h-64"></canvas>
                </div>
            </div>
        </div>
        <div id="tabPanel-data" class="tab-panel hidden min-h-[400px]" role="tabpanel" aria-labelledby="tab-data">
            <!-- Data Table Section -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-xl font-semibold mb-4">Incident Data</h2>
                    <!-- Filters -->
                    <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                        <input type="text" id="searchInput" placeholder="Search..." class="border rounded px-3 py-2">
                        <select id="stateFilter" class="border rounded px-3 py-2">
                            <option value="">All States</option>
                        </select>
                        <select id="typeFilter" class="border rounded px-3 py-2">
                            <option value="">All Types</option>
                        </select>
                        <input type="date" id="dateFilter" class="border rounded px-3 py-2">
                    </div>
                    <!-- Table -->
                    <div class="overflow-x-auto no-scrollbar w-full max-h-[60vh] border rounded-lg shadow">
                        <table id="incidentsTable" class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50 sticky top-0 z-10">
                                <tr>
                                    <th class="px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                    <th class="px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Title</th>
                                    <th class="px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Location</th>
                                    <th class="px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Type</th>
                                    <th class="px-2 sm:px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Source</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="incidentsTableBody">
                                <!-- Data will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    <!-- Pagination controls (moved outside scrollable container) -->
                    <div id="paginationControls"></div>
                </div>
            </div>
        </div>
        <div id="tabPanel-about" class="tab-panel hidden min-h-[400px]" role="tabpanel" aria-labelledby="tab-about">
            <!-- About Section -->
            <div class="mt-4 bg-white rounded-lg shadow p-6">
                <h2 class="text-2xl font-semibold mb-4">About This Dashboard</h2>
                <div class="prose max-w-none">
                    <p class="text-gray-600">
                        This dashboard tracks and visualizes incidents of violence and hate crimes against Dalit, Bahujan, Adivasi, and minority communities across India. 
                        Our mission is to provide accurate, timely, and comprehensive data to raise awareness and promote accountability.
                    </p>
                    <div class="mt-4">
                        <h3 class="text-lg font-medium mb-2">Data Sources</h3>
                        <p class="text-gray-600">
                            Data is collected from verified news sources and media reports. We use a combination of RSS feeds and news APIs to gather information.
                        </p>
                    </div>
                    <div class="mt-4">
                        <h3 class="text-lg font-medium mb-2">Methodology</h3>
                        <p class="text-gray-600">
                            Each incident is verified through multiple sources when possible. We categorize incidents based on type, location, and affected community.
                            The data is updated regularly to provide near real-time tracking.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-white border-t mt-8">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">About</h3>
                    <p class="mt-4 text-sm text-gray-500">
                        A comprehensive dashboard tracking incidents of violence and hate crimes against marginalized communities in India.
                    </p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Data</h3>
                    <p class="mt-4 text-sm text-gray-500">
                        Last updated: <span id="lastUpdated" class="font-medium">Loading...</span>
                    </p>
                </div>
                <div>
                    <h3 class="text-sm font-semibold text-gray-400 tracking-wider uppercase">Contact</h3>
                    <p class="mt-4 text-sm text-gray-500">
                        For data corrections or suggestions, please contact us through our feedback form.
                    </p>
                </div>
            </div>
            <div class="mt-8 border-t border-gray-200 pt-8">
                <p class="text-center text-sm text-gray-400">
                    © <span id="currentYear"></span> Dalit Violence Tracker. All rights reserved.
                </p>
            </div>
        </div>
    </footer>

    <!-- Modal for Incident Details -->
    <div id="incidentModal" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3 text-center">
                <h3 class="text-lg leading-6 font-medium text-gray-900" id="modalTitle"></h3>
                <div class="mt-2 px-7 py-3">
                    <p class="text-sm text-gray-500" id="modalContent"></p>
                </div>
                <div class="items-center px-4 py-3">
                    <button id="closeModal" class="px-4 py-2 bg-indigo-600 text-white text-base font-medium rounded-md shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        Close
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="js/data.js"></script>
    <script type="module" src="js/map.js"></script>
    <script type="module" src="js/charts.js"></script>
    <script type="module" src="js/table.js"></script>
    <script type="module" src="js/app.js"></script>
    <script>
    // Tab switching logic
    const tabBtns = document.querySelectorAll('.tab-btn');
    const tabPanels = document.querySelectorAll('.tab-panel');
    tabBtns.forEach(btn => {
        btn.addEventListener('click', () => {
            tabBtns.forEach(b => b.setAttribute('aria-selected', 'false'));
            btn.setAttribute('aria-selected', 'true');
            tabPanels.forEach(panel => panel.classList.add('hidden'));
            document.getElementById('tabPanel-' + btn.id.replace('tab-', '')).classList.remove('hidden');
        });
    });
    // Theme toggle logic
    const themeToggle = document.getElementById('themeToggle');
    const themeIcon = document.getElementById('themeIcon');
    function setTheme(mode) {
        if (mode === 'dark') {
            document.body.classList.add('dark');
            themeIcon.textContent = '☀️';
            localStorage.setItem('theme', 'dark');
        } else {
            document.body.classList.remove('dark');
            themeIcon.textContent = '🌙';
            localStorage.setItem('theme', 'light');
        }
    }
    function toggleTheme() {
        if (document.body.classList.contains('dark')) {
            setTheme('light');
        } else {
            setTheme('dark');
        }
    }
    themeToggle.addEventListener('click', toggleTheme);
    // On load, set theme from localStorage or system
    const userTheme = localStorage.getItem('theme');
    if (userTheme) {
        setTheme(userTheme);
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        setTheme('dark');
    } else {
        setTheme('light');
    }
    </script>
</body>
</html> 